--- CMakeLists.txt.orig	2016-12-10 23:50:29 UTC
+++ CMakeLists.txt
@@ -23,6 +23,20 @@ include(LXQtCreatePkgConfigFile)
 include(LXQtCreatePortableHeaders)
 include(LXQtCompilerSettings NO_POLICY_SCOPE)
 
+include(CheckIncludeFiles)
+include(CheckLibraryExists)
+
+check_include_files("sys/socket.h;net/if.h;net/if_mib.h;net/if_types.h" HAVE_IF_H)
+check_library_exists(kvm kvm_getswapinfo "kvm.h" HAVE_KVM_H)
+check_library_exists(c sysctlbyname "sys/sysctl.h" HAVE_SYSCTL_H)
+
+if(HAVE_SYSCTL_H AND HAVE_KVM_H)
+    #set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -lc -lkvm")
+    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -lc -lkvm")
+endif()
+
+configure_file(config.h.in config.h)
+
 set(CMAKE_AUTOMOC ON)
 set(CMAKE_INCLUDE_CURRENT_DIR ON)
 
